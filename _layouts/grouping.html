---
layout: default
---

<article class="post">
  <header class="post-header">
    <h1 class="post-title">{{ page.title }}</h1>

    {%- if page.short_description -%}
      <p class="post-meta" style="margin-top:.5rem;">
        {{ page.short_description }}
      </p>
    {%- endif -%}
  </header>

  {%- if page.main_description -%}
    <section style="margin-top:1rem;">
      {{ page.main_description | markdownify }}
    </section>
  {%- endif -%}

  {%- assign grouping_pages = site.groupings -%}
  {%- assign subcategories = grouping_pages | where: "parent_grouping", page.title -%}
  {%- assign descendant_titles = "|" -%}
  {%- if subcategories and subcategories.size > 0 -%}
    {%- for sub in subcategories -%}
      {%- assign descendant_titles = descendant_titles | append: sub.title | append: "|" -%}
    {%- endfor -%}
  {%- endif -%}
  {%- for candidate in grouping_pages -%}
    {%- if candidate.parent_grouping and descendant_titles contains candidate.parent_grouping -%}
      {%- assign descendant_titles = descendant_titles | append: candidate.title | append: "|" -%}
    {%- endif -%}
  {%- endfor -%}


  <section style="margin-top:1.25rem;">
    <h2>Details</h2>
    <table>
      <tbody>
        {%- if page.parent_grouping -%}
		          {%- assign parent_grouping_doc = grouping_pages | where: "title", page.parent_grouping | first -%}
          <tr>
            <th style="text-align:left;">Parent Grouping</th>
                        <td>
              {%- if parent_grouping_doc -%}
                <a href="{{ parent_grouping_doc.url | relative_url }}">{{ page.parent_grouping }}</a>
              {%- else -%}
                {{ page.parent_grouping }}
              {%- endif -%}
            </td>
          </tr>
        {%- endif -%}

{%- if subcategories and subcategories.size > 0 -%}
          <tr>
            <th style="text-align:left;">Subcategories</th>
            <td>
              <ul>
			  {%- for sub in subcategories -%}
                  <li><a href="{{ sub.url | relative_url }}">{{ sub.title }}</a></li>
                {%- endfor -%}
				  </ul>
            </td>
          </tr>
        {%- endif -%}

        {%- if page.wikidata -%}
          <tr>
            <th style="text-align:left;">Wikidata Code</th>
            <td>
              <a href="https://www.wikidata.org/wiki/{{ page.wikidata }}" rel="nofollow">
                {{ page.wikidata }}
              </a>
            </td>
          </tr>
        {%- endif -%}
      </tbody>
    </table>
  </section>


  {%- assign featured_found = false -%}
  {%- assign featured_rows = "" -%}
  {%- assign printed_featured_entries = "" -%}
  {%- for entry in site.entries -%}
    {%- assign e = entry.entry | default: entry -%}
    {%- if e["featured-entry"] and entry.groupings -%}
      {%- for g in entry.groupings -%}
        {%- assign grouping_name = g.grouping | default: g -%}
        {%- assign is_match = false -%}
        {%- if grouping_name == page.title -%}
          {%- assign is_match = true -%}
        {%- elsif descendant_titles contains grouping_name -%}
          {%- assign is_match = true -%}
        {%- endif -%}
        {%- if is_match and printed_featured_entries contains entry.url -%}
          {%- assign is_match = false -%}
        {%- endif -%}
        {%- if is_match -%}
          {%- assign featured_found = true -%}
          {%- assign printed_featured_entries = printed_featured_entries | append: entry.url | append: "|" -%}
          {%- capture row -%}
            <tr>
              <td><a href="{{ entry.url | relative_url }}">{{ entry.title }}</a></td>
              <td>{{ e.short_description | default: "—" }}</td>
              <td>
                {%- if entry.license and entry.license.licence -%}
                  {%- assign license_doc = site.licenses | where: "title", entry.license.licence | first -%}
                  {%- if license_doc -%}
                    <a href="{{ license_doc.url | relative_url }}">{{ entry.license.licence }}</a>
                  {%- else -%}
                    {{ entry.license.licence }}
                  {%- endif -%}
                {%- else -%}
                  —
                {%- endif -%}
              </td>
              <td>
                {%- if e.thumbnail -%}
                  {%- if e.thumbnail contains "/" -%}
                    <img
                      src="{{ e.thumbnail | relative_url }}"
                      alt="{{ entry.title }} thumbnail"
                      loading="lazy"
                      style="width:80px; height:auto; border-radius:6px;"
                    />
                  {%- else -%}
                    {{ e.thumbnail }}
                  {%- endif -%}
                {%- else -%}
                  —
                {%- endif -%}
              </td>
            </tr>
          {%- endcapture -%}
          {%- assign featured_rows = featured_rows | append: row -%}
        {%- endif -%}
      {%- endfor -%}
    {%- endif -%}
  {%- endfor -%}

  {%- if featured_found -%}
    <section style="margin-top:1.5rem;">
      <h2>Featured Entries</h2>

      <table>
        <thead>
          <tr>
            <th style="text-align:left;">Entry</th>
            <th style="text-align:left;">Description</th>
            <th style="text-align:left;">License</th>
            <th style="text-align:left;">Thumbnail</th>
          </tr>
        </thead>
        <tbody>
          {{ featured_rows }}
        </tbody>
      </table>
    </section>
  {%- endif -%}

  <section style="margin-top:1.5rem;">
    <h2>Entries under this grouping</h2>

    <table>
      <thead>
        <tr>
          <th style="text-align:left;">Entry</th>
          <th style="text-align:left;">Relationship</th>
        </tr>
      </thead>
      <tbody>
        {%- assign found = false -%}
        {%- assign printed_entries = "" -%}
        {%- for entry in site.entries -%}
          {%- if entry.groupings -%}
            {%- for g in entry.groupings -%}
              {%- assign grouping_name = g.grouping | default: g -%}
              {%- assign is_match = false -%}
              {%- if grouping_name == page.title -%}
                {%- assign is_match = true -%}
              {%- elsif descendant_titles contains grouping_name -%}
                {%- assign is_match = true -%}
              {%- endif -%}
              {%- if is_match and printed_entries contains entry.url -%}
                {%- assign is_match = false -%}
              {%- endif -%}
              {%- if is_match -%}
                {%- assign found = true -%}
                {%- assign printed_entries = printed_entries | append: entry.url | append: "|" -%}
                <tr>
                  <td><a href="{{ entry.url | relative_url }}">{{ entry.title }}</a></td>
                  <td>{{ g.is_or_about_grouping | default: "—" }}</td>
                </tr>
              {%- endif -%}
            {%- endfor -%}
          {%- endif -%}
        {%- endfor -%}

        {%- unless found -%}
          <tr>
            <td colspan="2"><em>No entries listed.</em></td>
          </tr>
        {%- endunless -%}
      </tbody>
    </table>
  </section>

  {{ content }}
</article>
